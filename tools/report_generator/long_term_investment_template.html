<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ stock_code }} - é•·æœŸæŠ•è³‡åˆ†æãƒ¬ãƒãƒ¼ãƒˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #0ba360 0%, #3cba92 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .stock-info {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .info-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #0ba360;
        }
        
        .info-label {
            font-weight: bold;
            color: #666;
            font-size: 0.9em;
        }
        
        .info-value {
            font-size: 1.1em;
            margin-top: 5px;
        }
        
        .section {
            padding: 30px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .section-title {
            font-size: 1.5em;
            color: #495057;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #0ba360;
        }
        
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .chart-container {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        
        .chart-container img {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
        }
        
        .chart-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #495057;
        }
        
        .indicators-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .indicator-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e9ecef;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .indicator-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .indicator-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .indicator-name {
            font-weight: bold;
            color: #495057;
        }
        
        .indicator-value {
            font-size: 1.3em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .signal-buy {
            color: #28a745;
            background-color: #d4edda;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
        }
        
        .signal-sell {
            color: #dc3545;
            background-color: #f8d7da;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
        }
        
        .signal-neutral {
            color: #6c757d;
            background-color: #e2e3e5;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
        }
        
        .overall-signal {
            text-align: center;
            padding: 30px;
            margin: 20px 0;
            border-radius: 10px;
            font-size: 1.5em;
            font-weight: bold;
        }
        
        .signal-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .summary-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e9ecef;
        }
        
        .summary-value {
            font-size: 2em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .portfolio-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .portfolio-table th,
        .portfolio-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }
        
        .portfolio-table th {
            background-color: #f8f9fa;
            font-weight: bold;
            color: #495057;
        }
        
        .portfolio-table tr:hover {
            background-color: #f8f9fa;
        }
        
        .support-resistance {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        .level-list {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
        
        .level-list h4 {
            margin-bottom: 15px;
            color: #495057;
        }
        
        .level-item {
            padding: 8px 0;
            border-bottom: 1px solid #f8f9fa;
        }
        
        .level-item:last-child {
            border-bottom: none;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            color: #6c757d;
            font-size: 0.9em;
        }
        
        .long-term-indicator {
            background: #0ba360;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
            margin: 10px 0;
            display: inline-block;
        }
        
        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .support-resistance {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <div class="header">
            <h1>{{ stock_code }} - {{ stock_name }}</h1>
            <div class="subtitle">é•·æœŸæŠ•è³‡åˆ†æãƒ¬ãƒãƒ¼ãƒˆ - æ•°ãƒ¶æœˆã€œæ•°å¹´å‘ã‘</div>
        </div>
        
        <!-- åŸºæœ¬æƒ…å ± -->
        <div class="stock-info">
            <div class="info-grid">
                <div class="info-item">
                    <div class="info-label">éŠ˜æŸ„ã‚³ãƒ¼ãƒ‰</div>
                    <div class="info-value">{{ stock_code }}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">éŠ˜æŸ„å</div>
                    <div class="info-value">{{ stock_name }}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">æ¥­ç¨®</div>
                    <div class="info-value">{{ industry }}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">å¸‚å ´</div>
                    <div class="info-value">{{ market }}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">ç¾åœ¨ä¾¡æ ¼</div>
                    <div class="info-value">{{ current_price }} å††</div>
                </div>
                <div class="info-item">
                    <div class="info-label">åˆ†ææ—¥æ™‚</div>
                    <div class="info-value">{{ analysis_date }}</div>
                </div>
            </div>
        </div>
        
        <!-- ç·åˆè©•ä¾¡ -->
        <div class="section">
            <h2 class="section-title">ç·åˆè©•ä¾¡</h2>
            <div class="overall-signal {{ overall_signal_class }}">
                {{ overall_signal }}
            </div>
            <div class="signal-summary">
                <div class="summary-card">
                    <div>è²·ã„ã‚·ã‚°ãƒŠãƒ«</div>
                    <div class="summary-value signal-buy">{{ buy_count }}</div>
                </div>
                <div class="summary-card">
                    <div>å£²ã‚Šã‚·ã‚°ãƒŠãƒ«</div>
                    <div class="summary-value signal-sell">{{ sell_count }}</div>
                </div>
                <div class="summary-card">
                    <div>åˆ†æã‚¿ã‚¤ãƒ—</div>
                    <div class="summary-value">é•·æœŸæŠ•è³‡</div>
                </div>
            </div>
            {% if overall_signal_class == 'signal-buy' %}
            <div class="long-term-indicator">ğŸŒ± é•·æœŸæˆé•·æœŸå¾…</div>
            {% elif overall_signal_class == 'signal-sell' %}
            <div class="long-term-indicator">âš ï¸ é•·æœŸãƒªã‚¹ã‚¯æ³¨æ„</div>
            {% endif %}
        </div>
        
        <!-- ãƒãƒ£ãƒ¼ãƒˆè¡¨ç¤º -->
        <div class="section">
            <h2 class="section-title">ãƒãƒ£ãƒ¼ãƒˆåˆ†æï¼ˆ5å¹´æ¨ç§»ï¼‰</h2>
            <div class="charts-grid">
                {% if price_chart_path %}
                <div class="chart-container">
                    <div class="chart-title">ä¾¡æ ¼ãƒãƒ£ãƒ¼ãƒˆï¼ˆé•·æœŸï¼‰</div>
                    <img src="{{ price_chart_path }}" alt="ä¾¡æ ¼ãƒãƒ£ãƒ¼ãƒˆ">
                </div>
                {% endif %}
                
                {% if technical_chart_path %}
                <div class="chart-container">
                    <div class="chart-title">ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™</div>
                    <img src="{{ technical_chart_path }}" alt="ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«ãƒãƒ£ãƒ¼ãƒˆ">
                </div>
                {% endif %}
                
                {% if signal_summary_path %}
                <div class="chart-container">
                    <div class="chart-title">ã‚·ã‚°ãƒŠãƒ«ã‚µãƒãƒªãƒ¼</div>
                    <img src="{{ signal_summary_path }}" alt="ã‚·ã‚°ãƒŠãƒ«ã‚µãƒãƒªãƒ¼">
                </div>
                {% endif %}
            </div>
        </div>
        
        <!-- é•·æœŸä¾¡æ ¼å¤‰å‹• -->
        <div class="section">
            <h2 class="section-title">é•·æœŸä¾¡æ ¼å¤‰å‹•</h2>
            <div class="indicators-grid">
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">50æ—¥å¤‰å‹•ç‡</div>
                        <div class="{{ price_change_50d_class }}">{{ price_change_50d }}</div>
                    </div>
                    <div class="indicator-value">{{ price_change_50d }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">100æ—¥å¤‰å‹•ç‡</div>
                        <div class="{{ price_change_100d_class }}">{{ price_change_100d }}</div>
                    </div>
                    <div class="indicator-value">{{ price_change_100d }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">200æ—¥å¤‰å‹•ç‡</div>
                        <div class="{{ price_change_200d_class }}">{{ price_change_200d }}</div>
                    </div>
                    <div class="indicator-value">{{ price_change_200d }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">1å¹´å¤‰å‹•ç‡</div>
                        <div class="{{ price_change_1y_class }}">{{ price_change_1y }}</div>
                    </div>
                    <div class="indicator-value">{{ price_change_1y }}</div>
                </div>
            </div>
        </div>
        
        <!-- é•·æœŸãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™ -->
        <div class="section">
            <h2 class="section-title">é•·æœŸãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™</h2>
            <div class="indicators-grid">
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">50æ—¥ç§»å‹•å¹³å‡</div>
                    </div>
                    <div class="indicator-value">{{ sma_50 }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">100æ—¥ç§»å‹•å¹³å‡</div>
                    </div>
                    <div class="indicator-value">{{ sma_100 }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">200æ—¥ç§»å‹•å¹³å‡</div>
                    </div>
                    <div class="indicator-value">{{ sma_200 }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">26é€±RSI</div>
                        <div class="{{ rsi_class }}">{{ rsi_interpretation }}</div>
                    </div>
                    <div class="indicator-value">{{ rsi_26 }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">é•·æœŸãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£</div>
                    </div>
                    <div class="indicator-value">{{ volatility_200d }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">ãƒˆãƒ¬ãƒ³ãƒ‰å¼·åº¦</div>
                    </div>
                    <div class="indicator-value">{{ trend_strength }}%</div>
                    <div>{{ trend_direction }}</div>
                </div>
            </div>
        </div>
        
        <!-- é•·æœŸã‚·ã‚°ãƒŠãƒ« -->
        <div class="section">
            <h2 class="section-title">é•·æœŸæŠ•è³‡ã‚·ã‚°ãƒŠãƒ«</h2>
            <div class="indicators-grid">
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">ãƒˆãƒ¬ãƒ³ãƒ‰ã‚·ã‚°ãƒŠãƒ«</div>
                    </div>
                    <div class="indicator-value {{ trend_signal_class }}">{{ trend_signal }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">RSIã‚·ã‚°ãƒŠãƒ«</div>
                    </div>
                    <div class="indicator-value {{ rsi_signal_class }}">{{ rsi_signal }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">MACDã‚·ã‚°ãƒŠãƒ«</div>
                    </div>
                    <div class="indicator-value {{ macd_signal_class }}">{{ macd_signal }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">ãƒœãƒªãƒ³ã‚¸ãƒ£ãƒ¼ã‚·ã‚°ãƒŠãƒ«</div>
                    </div>
                    <div class="indicator-value {{ bb_signal_class }}">{{ bb_signal }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">ãƒˆãƒ¬ãƒ³ãƒ‰å¼·åº¦ã‚·ã‚°ãƒŠãƒ«</div>
                    </div>
                    <div class="indicator-value {{ trend_strength_signal_class }}">{{ trend_strength_signal }}</div>
                </div>
            </div>
        </div>
        
        <!-- ã‚µãƒãƒ¼ãƒˆãƒ»ãƒ¬ã‚¸ã‚¹ã‚¿ãƒ³ã‚¹ -->
        <div class="section">
            <h2 class="section-title">ã‚µãƒãƒ¼ãƒˆãƒ»ãƒ¬ã‚¸ã‚¹ã‚¿ãƒ³ã‚¹ãƒ¬ãƒ™ãƒ«</h2>
            <div class="support-resistance">
                <div class="level-list">
                    <h4>ã‚µãƒãƒ¼ãƒˆãƒ¬ãƒ™ãƒ«</h4>
                    {% for level in support_levels %}
                    <div class="level-item">{{ level }} å††</div>
                    {% endfor %}
                </div>
                <div class="level-list">
                    <h4>ãƒ¬ã‚¸ã‚¹ã‚¿ãƒ³ã‚¹ãƒ¬ãƒ™ãƒ«</h4>
                    {% for level in resistance_levels %}
                    <div class="level-item">{{ level }} å††</div>
                    {% endfor %}
                </div>
            </div>
        </div>
        
        <!-- ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªæƒ…å ± -->
        {% if portfolio_info %}
        <div class="section">
            <h2 class="section-title">ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªæƒ…å ±</h2>
            <table class="portfolio-table">
                <thead>
                    <tr>
                        <th>ä¿æœ‰åŒºåˆ†</th>
                        <th>è¨¼åˆ¸ä¼šç¤¾</th>
                        <th>å–å¾—æ—¥</th>
                        <th>å–å¾—ä¾¡æ ¼</th>
                        <th>æ•°é‡</th>
                        <th>ç¾åœ¨ä¾¡æ ¼</th>
                    </tr>
                </thead>
                <tbody>
                    {% for holding in portfolio_info %}
                    <tr>
                        <td>{{ holding.holding_type }}</td>
                        <td>{{ holding.broker }}</td>
                        <td>{{ holding.purchase_date }}</td>
                        <td>{{ holding.purchase_price }}</td>
                        <td>{{ holding.quantity }}</td>
                        <td>{{ holding.current_price }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}
        
        <!-- å–å¼•è¨ˆç”» -->
        {% if trading_plans %}
        <div class="section">
            <h2 class="section-title">å–å¼•è¨ˆç”»</h2>
            <table class="portfolio-table">
                <thead>
                    <tr>
                        <th>å–å¼•åŒºåˆ†</th>
                        <th>ç›®æ¨™ä¾¡æ ¼</th>
                        <th>æ•°é‡</th>
                        <th>å„ªå…ˆåº¦</th>
                        <th>å‚™è€ƒ</th>
                    </tr>
                </thead>
                <tbody>
                    {% for plan in trading_plans %}
                    <tr>
                        <td>{{ plan.trade_type }}</td>
                        <td>{{ plan.target_price }}</td>
                        <td>{{ plan.quantity }}</td>
                        <td>{{ plan.priority }}</td>
                        <td>{{ plan.notes }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}
        
        <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
        <div class="footer">
            <p>ç”Ÿæˆæ—¥æ™‚: {{ analysis_date }}</p>
            <p>ã“ã®ãƒ¬ãƒãƒ¼ãƒˆã¯è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸã‚‚ã®ã§ã™ã€‚æŠ•è³‡åˆ¤æ–­ã¯è‡ªå·±è²¬ä»»ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚</p>
        </div>
    </div>
</body>
</html>
