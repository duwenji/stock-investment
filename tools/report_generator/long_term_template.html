<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ stock_code }} - 長期投資分析レポート</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .stock-info {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .info-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .info-label {
            font-weight: bold;
            color: #666;
            font-size: 0.9em;
        }
        
        .info-value {
            font-size: 1.1em;
            margin-top: 5px;
        }
        
        .section {
            padding: 30px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .section-title {
            font-size: 1.5em;
            color: #495057;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }
        
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .chart-container {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        
        .chart-container img {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
        }
        
        .chart-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #495057;
        }
        
        .indicators-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .indicator-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e9ecef;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .indicator-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .indicator-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .indicator-name {
            font-weight: bold;
            color: #495057;
        }
        
        .indicator-value {
            font-size: 1.3em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .signal-buy {
            color: #28a745;
            background-color: #d4edda;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
        }
        
        .signal-sell {
            color: #dc3545;
            background-color: #f8d7da;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
        }
        
        .signal-neutral {
            color: #6c757d;
            background-color: #e2e3e5;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
        }
        
        .overall-signal {
            text-align: center;
            padding: 30px;
            margin: 20px 0;
            border-radius: 10px;
            font-size: 1.5em;
            font-weight: bold;
        }
        
        .signal-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .summary-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e9ecef;
        }
        
        .summary-value {
            font-size: 2em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .portfolio-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .portfolio-table th,
        .portfolio-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }
        
        .portfolio-table th {
            background-color: #f8f9fa;
            font-weight: bold;
            color: #495057;
        }
        
        .portfolio-table tr:hover {
            background-color: #f8f9fa;
        }
        
        .support-resistance {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        .level-list {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
        
        .level-list h4 {
            margin-bottom: 15px;
            color: #495057;
        }
        
        .level-item {
            padding: 8px 0;
            border-bottom: 1px solid #f8f9fa;
        }
        
        .level-item:last-child {
            border-bottom: none;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            color: #6c757d;
            font-size: 0.9em;
        }
        
        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .support-resistance {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ヘッダー -->
        <div class="header">
            <h1>{{ stock_code }} - {{ stock_name }}</h1>
            <div class="subtitle">長期投資分析レポート</div>
        </div>
        
        <!-- 基本情報 -->
        <div class="stock-info">
            <div class="info-grid">
                <div class="info-item">
                    <div class="info-label">銘柄コード</div>
                    <div class="info-value">{{ stock_code }}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">銘柄名</div>
                    <div class="info-value">{{ stock_name }}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">業種</div>
                    <div class="info-value">{{ industry }}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">市場</div>
                    <div class="info-value">{{ market }}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">現在価格</div>
                    <div class="info-value">{{ current_price }} 円</div>
                </div>
                <div class="info-item">
                    <div class="info-label">分析日時</div>
                    <div class="info-value">{{ analysis_date }}</div>
                </div>
            </div>
        </div>
        
        <!-- 総合評価 -->
        <div class="section">
            <h2 class="section-title">総合評価</h2>
            <div class="overall-signal {{ overall_signal_class }}">
                {{ overall_signal }}
            </div>
            <div class="signal-summary">
                <div class="summary-card">
                    <div>買いシグナル</div>
                    <div class="summary-value signal-buy">{{ buy_count }}</div>
                </div>
                <div class="summary-card">
                    <div>売りシグナル</div>
                    <div class="summary-value signal-sell">{{ sell_count }}</div>
                </div>
                <div class="summary-card">
                    <div>分析タイプ</div>
                    <div class="summary-value">{{ analysis_type }}</div>
                </div>
            </div>
        </div>
        
        <!-- チャート表示 -->
        <div class="section">
            <h2 class="section-title">チャート分析</h2>
            <div class="charts-grid">
                {% if price_chart_path %}
                <div class="chart-container">
                    <div class="chart-title">価格チャート（長期）</div>
                    <img src="{{ price_chart_path }}" alt="価格チャート">
                </div>
                {% endif %}
                
                {% if technical_chart_path %}
                <div class="chart-container">
                    <div class="chart-title">テクニカル指標</div>
                    <img src="{{ technical_chart_path }}" alt="テクニカルチャート">
                </div>
                {% endif %}
                
                {% if signal_summary_path %}
                <div class="chart-container">
                    <div class="chart-title">シグナルサマリー</div>
                    <img src="{{ signal_summary_path }}" alt="シグナルサマリー">
                </div>
                {% endif %}
            </div>
        </div>
        
        <!-- 長期価格変動 -->
        <div class="section">
            <h2 class="section-title">長期価格変動</h2>
            <div class="indicators-grid">
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">50日変動率</div>
                        <div class="{{ price_change_50d_class }}">{{ price_change_50d }}</div>
                    </div>
                    <div class="indicator-value">{{ price_change_50d }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">100日変動率</div>
                        <div class="{{ price_change_100d_class }}">{{ price_change_100d }}</div>
                    </div>
                    <div class="indicator-value">{{ price_change_100d }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">200日変動率</div>
                        <div class="{{ price_change_200d_class }}">{{ price_change_200d }}</div>
                    </div>
                    <div class="indicator-value">{{ price_change_200d }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">1年変動率</div>
                        <div class="{{ price_change_1y_class }}">{{ price_change_1y }}</div>
                    </div>
                    <div class="indicator-value">{{ price_change_1y }}</div>
                </div>
            </div>
        </div>
        
        <!-- 長期テクニカル指標 -->
        <div class="section">
            <h2 class="section-title">長期テクニカル指標</h2>
            <div class="indicators-grid">
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">50日移動平均</div>
                    </div>
                    <div class="indicator-value">{{ sma_50 }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">100日移動平均</div>
                    </div>
                    <div class="indicator-value">{{ sma_100 }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">200日移動平均</div>
                    </div>
                    <div class="indicator-value">{{ sma_200 }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">26週RSI</div>
                        <div class="{{ rsi_class }}">{{ rsi_interpretation }}</div>
                    </div>
                    <div class="indicator-value">{{ rsi_26 }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">長期ボラティリティ</div>
                    </div>
                    <div class="indicator-value">{{ volatility_200d }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">トレンド強度</div>
                    </div>
                    <div class="indicator-value">{{ trend_strength }}%</div>
                    <div>{{ trend_direction }}</div>
                </div>
            </div>
        </div>
        
        <!-- 長期シグナル -->
        <div class="section">
            <h2 class="section-title">長期投資シグナル</h2>
            <div class="indicators-grid">
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">トレンドシグナル</div>
                    </div>
                    <div class="indicator-value {{ trend_signal_class }}">{{ trend_signal }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">RSIシグナル</div>
                    </div>
                    <div class="indicator-value {{ rsi_signal_class }}">{{ rsi_signal }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">MACDシグナル</div>
                    </div>
                    <div class="indicator-value {{ macd_signal_class }}">{{ macd_signal }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">ボリンジャーシグナル</div>
                    </div>
                    <div class="indicator-value {{ bb_signal_class }}">{{ bb_signal }}</div>
                </div>
                
                <div class="indicator-card">
                    <div class="indicator-header">
                        <div class="indicator-name">トレンド強度シグナル</div>
                    </div>
                    <div class="indicator-value {{ trend_strength_signal_class }}">{{ trend_strength_signal }}</div>
                </div>
            </div>
        </div>
        
        <!-- サポート・レジスタンス -->
        <div class="section">
            <h2 class="section-title">サポート・レジスタンスレベル</h2>
            <div class="support-resistance">
                <div class="level-list">
                    <h4>サポートレベル</h4>
                    {% for level in support_levels %}
                    <div class="level-item">{{ level }} 円</div>
                    {% endfor %}
                </div>
                <div class="level-list">
                    <h4>レジスタンスレベル</h4>
                    {% for level in resistance_levels %}
                    <div class="level-item">{{ level }} 円</div>
                    {% endfor %}
                </div>
            </div>
        </div>
        
        <!-- ポートフォリオ情報 -->
        {% if portfolio_info %}
        <div class="section">
            <h2 class="section-title">ポートフォリオ情報</h2>
            <table class="portfolio-table">
                <thead>
                    <tr>
                        <th>保有区分</th>
                        <th>証券会社</th>
                        <th>取得日</th>
                        <th>取得価格</th>
                        <th>数量</th>
                        <th>現在価格</th>
                    </tr>
                </thead>
                <tbody>
                    {% for holding in portfolio_info %}
                    <tr>
                        <td>{{ holding.holding_type }}</td>
                        <td>{{ holding.broker }}</td>
                        <td>{{ holding.purchase_date }}</td>
                        <td>{{ holding.purchase_price }}</td>
                        <td>{{ holding.quantity }}</td>
                        <td>{{ holding.current_price }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}
        
        <!-- 取引計画 -->
        {% if trading_plans %}
        <div class="section">
            <h2 class="section-title">取引計画</h2>
            <table class="portfolio-table">
                <thead>
                    <tr>
                        <th>取引区分</th>
                        <th>目標価格</th>
                        <th>数量</th>
                        <th>優先度</th>
                        <th>備考</th>
                    </tr>
                </thead>
                <tbody>
                    {% for plan in trading_plans %}
                    <tr>
                        <td>{{ plan.trade_type }}</td>
                        <td>{{ plan.target_price }}</td>
                        <td>{{ plan.quantity }}</td>
                        <td>{{ plan.priority }}</td>
                        <td>{{ plan.notes }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}
        
        <!-- フッター -->
        <div class="footer">
            <p>生成日時: {{ analysis_date }}</p>
            <p>このレポートは自動生成されたものです。投資判断は自己責任でお願いします。</p>
        </div>
    </div>
</body>
</html>
